<div id="cmq-root" style="width:100%;max-width:900px;margin:0 auto;padding:40px 20px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;box-sizing:border-box;">

  <div class="cmq-box">
    <div class="cmq-header">
      <h2>¿No sabés qué comprar?</h2>
      <p>Respondé estas preguntas y te guiamos</p>
    </div>

    <div class="cmq-progress">
      <div class="cmq-bar"><div class="cmq-bar-fill"></div></div>
      <div class="cmq-step-text"></div>
    </div>

    <div class="cmq-body"></div>

    <div class="cmq-footer">
      <button class="cmq-back">Volver</button>
      <button class="cmq-next">Siguiente</button>
    </div>
  </div>

</div>

<style>
  .cmq-box{background:#fff;border-radius:16px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,.1)}
  .cmq-header h2{margin:0;font-size:28px;color:#111}
  .cmq-header p{margin:6px 0 0;color:#555}
  .cmq-progress{margin:25px 0}
  .cmq-bar{height:6px;background:#eee;border-radius:6px;overflow:hidden}
  .cmq-bar-fill{height:100%;width:0;background:#ff6b35;transition:width .3s}
  .cmq-step-text{margin-top:8px;font-size:13px;color:#666;text-align:center}
  .cmq-body{margin-top:25px}
  .cmq-question{font-size:20px;font-weight:700;margin-bottom:18px}
  .cmq-option{border:2px solid #ddd;border-radius:10px;padding:14px 16px;margin-bottom:12px;cursor:pointer;font-weight:600}
  .cmq-option.active{border-color:#ff6b35;background:#fff3ee}
  .cmq-footer{display:flex;justify-content:space-between;margin-top:20px}
  .cmq-back{background:none;border:none;color:#666;font-weight:600;cursor:pointer}
  .cmq-next{background:#ff6b35;color:#fff;border:none;padding:12px 22px;border-radius:8px;font-weight:700;cursor:pointer}
  .cmq-next:disabled{opacity:.5}
  .cmq-results{text-align:center}
  .cmq-results h2{color:#111;margin-bottom:10px}
  .cmq-results p{color:#666;margin-bottom:30px}
  .cmq-products{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-top:20px}
  .cmq-product{background:#fff;border:1px solid #eee;border-radius:12px;padding:16px;cursor:pointer;transition:all .3s;text-decoration:none;color:inherit;position:relative}
  .cmq-product:hover{transform:translateY(-4px);box-shadow:0 8px 25px rgba(0,0,0,.15);border-color:#ff6b35}
  .cmq-product-img{width:100%;height:150px;object-fit:cover;border-radius:8px;margin-bottom:12px}
  .cmq-product-name{font-weight:600;color:#111;margin-bottom:8px;font-size:16px}
  .cmq-product-desc{color:#666;font-size:14px;line-height:1.4;margin-bottom:12px}
  .cmq-product-cta{background:#ff6b35;color:#fff;padding:8px 16px;border-radius:6px;font-size:12px;font-weight:600;text-align:center;margin-top:12px;transition:background .3s}
  .cmq-product:hover .cmq-product-cta{background:#e55a2b}
  .cmq-back-to-quiz{background:none;border:2px solid #ff6b35;color:#ff6b35;padding:10px 20px;border-radius:8px;font-weight:600;cursor:pointer;margin-top:30px}
</style>

<script>
(function(){
  const steps=[
    {k:"ambiente",q:"¿Para qué ambiente desea ver productos?",o:["Dormitorio","Living","Comedor","Oficina"]},
    {k:"presupuesto",q:"¿Cual es su presupuesto estimado?",o:["Económico","Intermedio","Premium"]},
    {k:"estilo",q:"¿Qué estilo es de su preferencia?",o:["Moderno","Clásico","Rústico"]},
    {k:"uso_persona",q:"¿Para cuántas personas es el producto?",o:["Para 1 persona","Para 2 personas","Para 3 o más personas"]},
    {k:"edad_persona",q:"¿Para quién está pensado principalmente?",o:["Adulto","Joven","Niño"]}
  ]

  // Todos los productos con metadatos para matching inteligente
  const allProducts=[
    // DORMITORIO
    {name:"Sommier Wish King",img:"https://f.fcdn.app/imgs/f8cf74/www.compramas.com.uy/comauy/436b/webp/catalogo/SO-Wish18_SO-Wish18_2/1500-1500/sommier-king-size-base-cama-colchon-de-espuma-y-resorte-pocket-sommier-king-size-base-cama-colchon-de-espuma-y-resorte-pocket.jpg",desc:"SOMMIER KING SIZE BASE CAMA COLCHÓN DE ESPUMA Y RESORTE POCKET",url:"https://www.compramas.com.uy/catalogo/sommier-king-size-base-cama-colchon-de-espuma-y-resorte-pocket_SO-Wish18_SO-Wish18",ambiente:["Dormitorio"],presupuesto:["Premium"],estilo:["Moderno"],uso_persona:["Para 2 personas"],edad_persona:["Adulto"]},
    {name:"Sommier Wish Queen",img:"https://f.fcdn.app/imgs/f8fc49/www.compramas.com.uy/comauy/436b/webp/catalogo/SO-Wish16_SO-Wish16_2/1500-1500/sommier-queen-size-base-cama-colchon-de-espuma-y-resorte-pocket-sommier-queen-size-base-cama-colchon-de-espuma-y-resorte-pocket.jpg",desc:"SOMMIER QUEEN SIZE BASE CAMA COLCHÓN DE ESPUMA Y RESORTE POCKET",url:"https://www.compramas.com.uy/catalogo/sommier-queen-size-base-cama-colchon-de-espuma-y-resorte-pocket_SO-Wish16_SO-Wish16",ambiente:["Dormitorio"],presupuesto:["Premium"],estilo:["Moderno"],uso_persona:["Para 2 personas"],edad_persona:["Adulto","Joven"]},
    {name:"Sommier Wish 2 plazas",img:"https://f.fcdn.app/imgs/3fe4ad/www.compramas.com.uy/comauy/a884/webp/catalogo/SO-WISH14_SO-WISH14_2/1500-1500/sommier-2-plazas-base-cama-colchon-de-espuma-y-resorte-pocket-sommier-2-plazas-base-cama-colchon-de-espuma-y-resorte-pocket.jpg",desc:"SOMMIER 2 PLAZAS BASE CAMA COLCHÓN DE ESPUMA Y RESORTE POCKET",url:"https://www.compramas.com.uy/catalogo/sommier-2-plazas-base-cama-colchon-de-espuma-y-resorte-pocket_SO-WISH14_SO-WISH14",ambiente:["Dormitorio"],presupuesto:["Intermedio"],estilo:["Moderno"],uso_persona:["Para 2 personas"],edad_persona:["Adulto","Joven"]},
    {name:"Sommier Wish 1/2",img:"https://f.fcdn.app/imgs/7313ff/www.compramas.com.uy/comauy/06c2/webp/catalogo/So-Wish12_So-Wish12_1/1000x1000/sommier-plaza-y-media-base-cama-colchon-de-espuma-y-resorte-pocket-sommier-plaza-y-media-base-cama-colchon-de-espuma-y-resorte-pocket.jpg",desc:"SOMMIER PLAZA Y MEDIA BASE CAMA COLCHÓN DE ESPUMA Y RESORTE POCKET",url:"https://www.compramas.com.uy/catalogo/sommier-plaza-y-media-base-cama-colchon-de-espuma-y-resorte-pocket_So-Wish12_So-Wish12",ambiente:["Dormitorio"],presupuesto:["Intermedio"],estilo:["Moderno"],uso_persona:["Para 1 persona"],edad_persona:["Joven"]},
    {name:"Sommier Wish 1 plaza",img:"https://f.fcdn.app/imgs/d506d9/www.compramas.com.uy/comauy/f57b/webp/catalogo/SOM-WISH88_SOM-WISH88_2/1500-1500/sommier-1-plaza-base-cama-colchon-de-espuma-y-resorte-pocket-sommier-1-plaza-base-cama-colchon-de-espuma-y-resorte-pocket.jpg",desc:"SOMMIER 1 PLAZA BASE CAMA COLCHÓN DE ESPUMA Y RESORTE POCKET",url:"https://www.compramas.com.uy/catalogo/sommier-1-plaza-base-cama-colchon-de-espuma-y-resorte-pocket_SOM-WISH88_SOM-WISH88",ambiente:["Dormitorio"],presupuesto:["Intermedio", "Económico"],estilo:["Moderno"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Niño"]},

    {name:"Baul Queen",img:"https://f.fcdn.app/imgs/70f86d/www.compramas.com.uy/comauy/99d7/webp/catalogo/BAUL-160_BAUL-160GR_1/1500-1500/box-baul-queen-size-base-de-sommier-guardarropa-cama-importado-gris.jpg",desc:"BOX BAÙL QUEEN SIZE BASE DE SOMMIER GUARDARROPA CAMA IMPORTADO",url:"https://www.compramas.com.uy/catalogo/box-baul-queen-size-base-de-sommier-guardarropa-cama-importado-gris_BAUL-160_BAUL-160GR",ambiente:["Dormitorio"],presupuesto:["Intermedio"],estilo:["Moderno"],uso_persona:["Para 2 personas"],edad_persona:["Adulto","Joven"]},
    {name:"Baul 2 plazas",img:"https://f.fcdn.app/imgs/872192/www.compramas.com.uy/comauy/a610/webp/catalogo/BAUL-140_BAUL-140GR_1/1500-1500/box-baul-2-plazas-base-de-sommier-guardarropa-cama-gris.jpg",desc:"BOX BAÚL 2 PLAZAS BASE DE SOMMIER GUARDARROPA CAMA",url:"https://www.compramas.com.uy/catalogo/box-baul-2-plazas-base-de-sommier-guardarropa-cama-gris_BAUL-140_BAUL-140GR",ambiente:["Dormitorio"],presupuesto:["Intermedio"],estilo:["Moderno"],uso_persona:["Para 2 personas"],edad_persona:["Adulto","Joven","Anciano"]},
    {name:"Baul 1/2",img:"https://f.fcdn.app/imgs/3ee550/www.compramas.com.uy/comauy/587b/webp/catalogo/BAUL_-12GR_1/1500-1500/box-baul-plaza-y-media-base-guadarropa-cama-gris.jpg",desc:"BOX BAÚL PLAZA Y MEDIA BASE GUADARROPA CAMA",url:"https://www.compramas.com.uy/catalogo/box-baul-plaza-y-media-base-guadarropa-cama-gris_BAUL_-12GR",ambiente:["Dormitorio"],presupuesto:["Intermedio"],estilo:["Moderno"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Adulto","Anciano"]},
    {name:"Baul 1 plaza",img:"https://f.fcdn.app/imgs/490555/www.compramas.com.uy/comauy/1ba1/webp/catalogo/BAUL-090_BAUL-090GR_1/1500-1500/box-baul-1-plazas-base-de-sommier-guardarropa-cama-con-apertura-lateral-gris.jpg",desc:"BOX BAÙL 1 PLAZAS BASE DE SOMMIER GUARDARROPA CAMA CON APERTURA LATERAL",url:"https://www.compramas.com.uy/catalogo/box-baul-1-plazas-base-de-sommier-guardarropa-cama-con-apertura-lateral-gris_BAUL-090_BAUL-090GR",ambiente:["Dormitorio"],presupuesto:["Intermedio", "Económico"],estilo:["Moderno"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Niño"]},

    {name:"Ropero americano",img:"https://f.fcdn.app/imgs/042b08/www.compramas.com.uy/comauy/4139/webp/catalogo/RP-2630BL_RP-2630BL_1/1500-1500/ropero-6-puertas-3-cajones-guardarropa-armario-placard-closet-linea-americana-ropero-6-puertas-3-cajones-guardarropa-armario-placard-closet-linea-americana.jpg",desc:"ROPERO 6 PUERTAS 3 CAJONES GUARDARROPA ARMARIO PLACARD CLOSET",url:"https://www.compramas.com.uy/catalogo/ropero-6-puertas-3-cajones-guardarropa-armario-placard-closet-linea-americana_RP-2630BL_RP-2630BL",ambiente:["Dormitorio"],presupuesto:["Intermedio","Premium"],estilo:["Clásico"],uso_persona:["Para 3 o más personas","Para 2 personas"],edad_persona:["Adulto"]},
    {name:"Ropero 6 puertas",img:"https://f.fcdn.app/imgs/97b8a0/www.compramas.com.uy/comauy/0610/webp/catalogo/B375-215_B375-215_1/1500-1500/ropero-6-puertas-3-cajones-guardarropa-armario-placard-closet-ropero-6-puertas-3-cajones-guardarropa-armario-placard-closet.jpg",desc:"ROPERO 6 PUERTAS 3 CAJONES GUARDARROPA ARMARIO PLACARD CLOSET",url:"https://www.compramas.com.uy/catalogo/ropero-6-puertas-3-cajones-guardarropa-armario-placard-closet_B375-215_B375-215",ambiente:["Dormitorio"],presupuesto:["Intermedio","Premium"],estilo:["Moderno"],uso_persona:["Para 2 personas","Para 3 o más personas"],edad_persona:["Adulto"]},
    {name:"Ropero 4 puertas 2 cajones",img:"https://f.fcdn.app/imgs/4f4295/www.compramas.com.uy/comauy/91c9/webp/catalogo/RP-2425BL_RP-2425BL_1/1500-1500/ropero-4-puertas-2-cajones-guardarropa-armario-placard-closet-linea-americana-ropero-4-puertas-2-cajones-guardarropa-armario-placard-closet-linea-americana.jpg",desc:"ROPERO 4 PUERTAS 2 CAJONES GUARDARROPA ARMARIO PLACARD CLOSET",url:"https://www.compramas.com.uy/catalogo/ropero-4-puertas-2-cajones-guardarropa-armario-placard-closet-linea-americana_RP-2425BL_RP-2425BL",ambiente:["Dormitorio"],presupuesto:["Intermedio","Premium"],estilo:["Clásico"],uso_persona:["Para 2 personas","Para 1 persona"],edad_persona:["Adulto","Joven"]},
    {name:"4 puertas 2 cajones",img:"https://f.fcdn.app/imgs/e48791/www.compramas.com.uy/comauy/f7b7/webp/catalogo/RP1420_RP1420-MG_1/1000x1000/ropero-4-puertas-2-cajones-guardarropa-armario-closet-placard-color-madera-gris.jpg",desc:"ROPERO 4 PUERTAS 2 CAJONES GUARDARROPA ARMARIO CLOSET PLACARD",url:"https://www.compramas.com.uy/catalogo/ropero-4-puertas-2-cajones-guardarropa-armario-closet-placard-color-madera-gris_RP1420_RP1420-MG",ambiente:["Dormitorio"],presupuesto:["Intermedio","Económico"],estilo:["Clásico","Rústico"],uso_persona:["Para 2 personas","Para 1 persona"],edad_persona:["Adulto","Joven"]},
    {name:"4 puertaas mexicana",img:"https://f.fcdn.app/imgs/bc182b/www.compramas.com.uy/comauy/67d3/webp/catalogo/AM002_AM002-CR_1/1500-1500/ropero-4-puertas-guardarropa-armario-placard-closet-en-madera-maciza-linea-mexicana-color-madera.jpg",desc:"ROPERO 4 PUERTAS GUARDARROPA ARMARIO PLACARD CLOSET EN MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/ropero-4-puertas-guardarropa-armario-placard-closet-en-madera-maciza-linea-mexicana-color-madera_AM002_AM002-CR",ambiente:["Dormitorio"],presupuesto:["Intermedio","Premium"],estilo:["Clásico","Rústico"],uso_persona:["Para 2 personas","Para 1 persona"],edad_persona:["Adulto","Joven"]},
    {name:"2 puertas infantil",img:"https://f.fcdn.app/imgs/9169c7/www.compramas.com.uy/comauy/38ac/webp/catalogo/I117_I117-10BL_1/1500-1500/ropero-2-puertas-2-cajones-guardarropa-armario-placard-closet-infantil-blanco.jpg",desc:"ROPERO 2 PUERTAS 2 CAJONES GUARDARROPA ARMARIO PLACARD CLOSET INFANTIL",url:"https://www.compramas.com.uy/catalogo/ropero-2-puertas-2-cajones-guardarropa-armario-placard-closet-infantil-blanco_I117_I117-10BL",ambiente:["Dormitorio"],presupuesto:["Intermedio","Económico"],estilo:["Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Niño"]},

    {name:"comoda espejo",img:"https://f.fcdn.app/imgs/036a90/www.compramas.com.uy/comauy/15a3/webp/catalogo/B700_B700-10BL_1/1500-1500/comoda-guardarropa-estanteria-3-cajones-2-puertas-con-espejo-blanco.jpg",desc:"CÓMODA GUARDARROPA ESTANTERÍA 3 CAJONES 2 PUERTAS CON ESPEJO",url:"https://www.compramas.com.uy/catalogo/comoda-guardarropa-estanteria-3-cajones-2-puertas-con-espejo-blanco_B700_B700-10BL",ambiente:["Dormitorio"],presupuesto:["Económico","Intermedio"],estilo:["Clásico"],uso_persona:["Para 1 persona","Para 2 personas"],edad_persona:["Joven","Adulto"]},
    {name:"comoda con llave",img:"https://f.fcdn.app/imgs/8ecf7a/www.compramas.com.uy/comauy/bcb1/webp/catalogo/CO260_CO260-VE_1/1500-1500/comoda-cajonera-guardarropa-4-cajones-2-puertas-con-llave-color-madera-verde.jpg",desc:"CÓMODA CAJONERA GUARDARROPA 4 CAJONES 2 PUERTAS CON LLAVE",url:"https://www.compramas.com.uy/catalogo/comoda-cajonera-guardarropa-4-cajones-2-puertas-con-llave-color-madera-verde_CO260_CO260-VE",ambiente:["Dormitorio"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Rústico","Clásico"],uso_persona:["Para 1 persona","Para 2 personas"],edad_persona:["Joven","Adulto"]},
    {name:"comoda mexicana",img:"https://f.fcdn.app/imgs/ad3a4e/www.compramas.com.uy/comauy/95c1/webp/catalogo/P2601_P2601-CR_1/1500-1500/comoda-cajonera-guardarropa-3-cajones-en-madera-maciza-linea-mexicana-color-madera.jpg",desc:"CÓMODA CAJONERA GUARDARROPA 3 CAJONES EN MADERA MACIZA - LÌNEA MEXICANA",url:"https://www.compramas.com.uy/catalogo/comoda-cajonera-guardarropa-3-cajones-en-madera-maciza-linea-mexicana-color-madera_P2601_P2601-CR",ambiente:["Dormitorio"],presupuesto:["Económico","Intermedio"],estilo:["Rústico"],uso_persona:["Para 1 persona","Para 2 personas"],edad_persona:["Joven","Adulto"]},

    {name:"cucheta infantil",img:"https://f.fcdn.app/imgs/fffdd0/www.compramas.com.uy/comauy/b247/webp/catalogo/CU-1111_CU-1111_1/1500-1500/cucheta-infantil-de-1-plaza-en-madera-maciza-cucheta-infantil-de-1-plaza-en-madera-maciza.jpg",desc:"CUCHETA INFANTIL DE 1 PLAZA EN MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/cucheta-infantil-de-1-plaza-en-madera-maciza_CU-1111_CU-1111",ambiente:["Dormitorio"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Rústico","Clásico"],uso_persona:["Para 2 personas"],edad_persona:["Niño"]},
    {name:"cuna",img:"https://f.fcdn.app/imgs/531256/www.compramas.com.uy/comauy/be7c/webp/catalogo/I19_I19-18RU_1/1000x1000/cuna-de-bebe-color-madera.jpg",desc:"CUNA DE BEBÉ",url:"https://www.compramas.com.uy/catalogo/cuna-de-bebe-color-madera_I19_I19-18RU",ambiente:["Dormitorio"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Niño"]},

    {name:"mesa madera maciza",img:"https://f.fcdn.app/imgs/8142e3/www.compramas.com.uy/comauy/4c67/webp/catalogo/LA001-MV_LA001-MB_1/1500-1500/mesa-de-luz-o-noche-3-cajones-en-madera-maciza-blanco.jpg",desc:"MESA DE LUZ O NOCHE 3 CAJONES EN MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/mesa-de-luz-o-noche-3-cajones-en-madera-maciza-blanco_LA001-MV_LA001-MB",ambiente:["Dormitorio"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Adulto"]},
    {name:"mesa mexicana",img:"https://f.fcdn.app/imgs/992c5e/www.compramas.com.uy/comauy/25ce/webp/catalogo/P101_P101-CR_1/1500-1500/mesa-de-luz-o-noche-1-puerta-1-cajon-madera-maciza-en-linea-mexicana-color-madera.jpg",desc:"MESA DE LUZ O NOCHE 1 PUERTA 1 CAJÓN MADERA MACIZA EN LÍNEA MEXICANA",url:"https://www.compramas.com.uy/catalogo/mesa-de-luz-o-noche-1-puerta-1-cajon-madera-maciza-en-linea-mexicana-color-madera_P101_P101-CR",ambiente:["Dormitorio"],presupuesto:["Económico","Intermedio"],estilo:["Rústico"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Adulto"]},

    // LIVING
    {name:"Sofá parlantes",img:"https://f.fcdn.app/imgs/b42af3/www.compramas.com.uy/comauy/4003/webp/catalogo/K-2511_K-2511_1/1500-1500/sofa-sillon-esquinero-reclinable-retractil-con-sistema-electrico-en-cuero-genuino-sofa-sillon-esquinero-reclinable-retractil-con-sistema-electrico-en-cuero-genuino.jpg",desc:"SOFA SILLÓN ESQUINERO RECLINABLE RETRACTIL CON SISTEMA ELECTRICO EN CUERO GENUINO",url:"https://www.compramas.com.uy/catalogo/sofa-sillon-esquinero-reclinable-retractil-con-sistema-electrico-en-cuero-genuino_K-2511_K-2511",ambiente:["Living"],presupuesto:["Premium"],estilo:["Moderno","Clásico"],uso_persona:["Para 3 o más personas","Para 2 personas"],edad_persona:["Adulto","Joven"]},
    {name:"chester",img:"https://f.fcdn.app/imgs/7d0c73/www.compramas.com.uy/comauy/7074/webp/catalogo/Chesterfield3l_2469-3L-MA_1/1500-1500/sofa-sillon-3-cuerpos-con-almohadones-marron.jpg",desc:"SOFÁ SILLÓN 3 CUERPOS - CON ALMOHADONES",url:"https://www.compramas.com.uy/catalogo/sofa-sillon-3-cuerpos-con-almohadones-marron_Chesterfield3l_2469-3L-MA",ambiente:["Living"],presupuesto:["Intermedio","Premium"],estilo:["Moderno","Rústico"],uso_persona:["Para 3 o más personas","Para 2 personas"],edad_persona:["Adulto","Joven"]},
    {name:"sofa 3 cuerpos",img:"https://f.fcdn.app/imgs/4e04ab/www.compramas.com.uy/comauy/a753/webp/catalogo/AC162_AC162-8121_1/1500-1500/sofa-sillon-3-cuerpos-patas-en-madera-beige.jpg",desc:"SOFA SILLÓN 3 CUERPOS PATAS EN MADERA",url:"https://www.compramas.com.uy/catalogo/sofa-sillon-3-cuerpos-patas-en-madera-beige_AC162_AC162-8121",ambiente:["Living"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Clásico"],uso_persona:["Para 2 personas"],edad_persona:["Joven","Adulto"]},
    {name:"chester poltrona",img:"https://f.fcdn.app/imgs/18498d/www.compramas.com.uy/comauy/ac9a/webp/catalogo/CHESTERFIELD1L_2469-1L-MA_1/1500-1500/sofa-sillon-1-cuerpo-con-almohadon-marron.jpg",desc:"SOFÁ SILLÓN 1 CUERPO - CON ALMOHADÓN",url:"https://www.compramas.com.uy/catalogo/sofa-sillon-1-cuerpo-con-almohadon-marron_CHESTERFIELD1L_2469-1L-MA",ambiente:["Living"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Rústico"],uso_persona:["Para 1 persona"],edad_persona:["Adulto","Joven"]},
    {name:"poltrona cuero",img:"https://f.fcdn.app/imgs/7f215c/www.compramas.com.uy/comauy/f271/webp/catalogo/K-2521_K-2521_1/1500-1500/sofa-sillon-poltrona-reclinable-retractil-con-sistema-electrico-y-en-cuero-genuino-sofa-sillon-poltrona-reclinable-retractil-con-sistema-electrico-y-en-cuero-genuino.jpg",desc:"SOFA SILLÓN POLTRONA RECLINABLE RETRACTIL CON SISTEMA ELECTRICO Y EN CUERO GENUINO",url:"https://www.compramas.com.uy/catalogo/sofa-sillon-poltrona-reclinable-retractil-con-sistema-electrico-y-en-cuero-genuino_K-2521_K-2521",ambiente:["Living"],presupuesto:["Premium"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Adulto","Joven"]},
    {name:"poltrona",img:"https://f.fcdn.app/imgs/f2007f/www.compramas.com.uy/comauy/3283/webp/catalogo/ellie_P-ELLIE-DG_1/1500-1500/sofa-sillon-butaca-poltrona-1-cuerpo-gris-oscuro.jpg",desc:"SOFA SILLÓN BUTACA POLTRONA 1 CUERPO",url:"https://www.compramas.com.uy/catalogo/sofa-sillon-butaca-poltrona-1-cuerpo-gris-oscuro_ellie_P-ELLIE-DG",ambiente:["Living"],presupuesto:["Económico"],estilo:["Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Adulto","Joven"]},

    {name:"panel",img:"https://f.fcdn.app/imgs/7d5986/www.compramas.com.uy/comauy/b8ce/webp/catalogo/NT1370-OF_NT1370-OF_1/1500-1500/panel-para-tv-de-hasta-75-panel-para-tv-de-hasta-75.jpg",desc:"PANEL PARA TV DE HASTA 75''",url:"https://www.compramas.com.uy/catalogo/panel-para-tv-de-hasta-75_NT1370-OF_NT1370-OF",ambiente:["Living"],presupuesto:["Intermedio"],estilo:["Moderno"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Adulto","Joven"]},
    {name:"rack1",img:"https://f.fcdn.app/imgs/2a8a30/www.compramas.com.uy/comauy/94aa/webp/catalogo/R-52030CHR_R-52030CHR_1/1500-1500/rack-aparador-para-tv-o-audio-con-ruedas-rack-aparador-para-tv-o-audio-con-ruedas.jpg",desc:"RACK APARADOR PARA TV O AUDIO CON RUEDAS",url:"https://www.compramas.com.uy/catalogo/rack-aparador-para-tv-o-audio-con-ruedas_R-52030CHR_R-52030CHR",ambiente:["Living"],presupuesto:["Económico"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Adulto"]},
    {name:"rack2",img:"https://f.fcdn.app/imgs/493c37/www.compramas.com.uy/comauy/871a/webp/catalogo/DEN003_DEN003_1/1500-1500/rack-aparador-para-tv-o-audio-en-madera-maciza-rack-aparador-para-tv-o-audio-en-madera-maciza.jpg",desc:"RACK APARADOR PARA TV O AUDIO EN MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/rack-aparador-para-tv-o-audio-en-madera-maciza_DEN003_DEN003",ambiente:["Living"],presupuesto:["Intermedio"],estilo:["Moderno","Rústico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Adulto"]},

    {name:"Mesa centro nature",img:"https://f.fcdn.app/imgs/e67c6e/www.compramas.com.uy/comauy/3462/webp/catalogo/AH702_AH702_1/1500-1500/mesa-ratona-living-centro-madera-maciza-linea-rustica-mesa-ratona-living-centro-madera-maciza-linea-rustica.jpg",desc:"MESA RATONA LIVING CENTRO MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/mesa-ratona-living-centro-madera-maciza-linea-rustica_AH702_AH702",ambiente:["Living"],presupuesto:["Intermedio","Premium"],estilo:["Clásico","Rústico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Adulto","Joven"]},
    {name:"combo mesas",img:"https://f.fcdn.app/imgs/ea86b8/www.compramas.com.uy/comauy/d1b6/webp/catalogo/M-181843_M-181843_1/1500-1500/combo-mesa-de-living-centro-y-mesa-lateral-combo-mesa-de-living-centro-y-mesa-lateral.jpg",desc:"COMBO MESA DE LIVING CENTRO Y MESA LATERAL",url:"https://www.compramas.com.uy/catalogo/combo-mesa-de-living-centro-y-mesa-lateral_M-181843_M-181843",ambiente:["Living"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Adulto"]},

    // COMEDOR
    {name:"Mesa 6 sillas",img:"https://f.fcdn.app/imgs/66654a/www.compramas.com.uy/comauy/e120/webp/catalogo/1120P6unidadesde1107_1120P6unidadesde1107_1/1500-1500/juego-de-comedor-mesa-y-6-sillas-en-madera-maciza-juego-de-comedor-mesa-y-6-sillas-en-madera-maciza.jpg",desc:"JUEGO DE COMEDOR MESA Y 6 SILLAS EN MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/juego-de-comedor-mesa-y-6-sillas-en-madera-maciza_1120P6unidadesde1107_1120P6unidadesde1107",ambiente:["Comedor"],presupuesto:["Premium"],estilo:["Clásico","Rústico"],uso_persona:["Para 3 o más personas"],edad_persona:["Adulto","Joven"]},
    {name:"mesa butacas",img:"https://f.fcdn.app/imgs/697513/www.compramas.com.uy/comauy/27f7/webp/catalogo/J-LUMBER_J-LUMBER_1/1500-1500/juego-de-mesa-y-2-bancos-rectagulares-con-tapa-en-madera-maciza-juego-de-mesa-y-2-bancos-rectagulares-con-tapa-en-madera-maciza.jpg",desc:"JUEGO DE MESA Y 2 BANCOS RECTAGULARES CON TAPA EN MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/juego-de-mesa-y-2-bancos-rectagulares-con-tapa-en-madera-maciza_J-LUMBER_J-LUMBER",ambiente:["Comedor"],presupuesto:["Intermedio"],estilo:["Moderno","Rústico"],uso_persona:["Para 3 o más personas"],edad_persona:["Adulto","Joven"]},
    {name:"Mesa 4 personas",img:"https://f.fcdn.app/imgs/f9d5ac/www.compramas.com.uy/comauy/e706/webp/catalogo/JCP-04BL_JCP-04BL_1/1000x1000/juego-de-comedor-mesa-y-4-sillas-en-madera-maciza-juego-de-comedor-mesa-y-4-sillas-en-madera-maciza.jpg",desc:"JUEGO DE COMEDOR MESA Y 4 SILLAS EN MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/juego-de-comedor-mesa-y-4-sillas-en-madera-maciza_JCP-04BL_JCP-04BL",ambiente:["Comedor"],presupuesto:["Económico"],estilo:["Clásico","Rústico"],uso_persona:["Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Adulto"]},
    {name:"critalero",img:"https://f.fcdn.app/imgs/54addf/www.compramas.com.uy/comauy/0683/webp/catalogo/DC18-WHITE_DC18-WHITE_1/1500-1500/cristalero-4-puertas-armario-bar-copero-botellero-estanteria-blanco.jpg",desc:"CRISTALERO 4 PUERTAS ARMARIO BAR COPERO BOTELLERO ESTANTERÍA",url:"https://www.compramas.com.uy/catalogo/cristalero-4-puertas-armario-bar-copero-botellero-estanteria-blanco_DC18-WHITE_DC18-WHITE",ambiente:["Comedor"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Clásico","Rústico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Adulto"]},
    {name:"aparador moderno",img:"https://f.fcdn.app/imgs/7522e9/www.compramas.com.uy/comauy/f5b6/webp/catalogo/S350-127NW_S350-127NW_1/1000x1000/aparador-buffet-con-estante-inferior-de-calidad-premiun-aparador-buffet-con-estante-inferior-de-calidad-premiun.jpg",desc:"APARADOR BUFFET CON ESTANTE INFERIOR DE CALIDAD PREMIUN",url:"https://www.compramas.com.uy/catalogo/aparador-buffet-con-estante-inferior-de-calidad-premiun_S350-127NW_S350-127NW",ambiente:["Comedor"],presupuesto:["Económico"],estilo:["Moderno"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Adulto"]},
    {name:"aparador rustico",img:"https://f.fcdn.app/imgs/d79ef6/www.compramas.com.uy/comauy/3895/webp/catalogo/lr001_lr001-b_1/1500-1500/aparador-madera-maciza-mesa-auxiliar-con-cajon-color-blanco.jpg",desc:"APARADOR MADERA MACIZA MESA AUXILIAR CON CAJÓN",url:"https://www.compramas.com.uy/catalogo/aparador-madera-maciza-mesa-auxiliar-con-cajon-color-blanco_lr001_lr001-b",ambiente:["Comedor"],presupuesto:["Económico"],estilo:["Clásico","Rústico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Adulto","Joven"]},
    {name:"Aparador nature",img:"https://f.fcdn.app/imgs/a8da65/www.compramas.com.uy/comauy/8cbc/webp/catalogo/Y5211_Y5211_1/1000x1000/buffet-armario-cocina-estanteria-madera-maciza-linea-rustica-buffet-armario-cocina-estanteria-madera-maciza-linea-rustica.jpg",desc:"BUFFET ARMARIO COCINA ESTANTERÍA MADERA MACIZA LÍNEA RÚSTICA",url:"https://www.compramas.com.uy/catalogo/buffet-armario-cocina-estanteria-madera-maciza-linea-rustica_Y5211_Y5211",ambiente:["Comedor"],presupuesto:["Premium"],estilo:["Clásico","Rústico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Adulto","Joven"]},

    // OFICINA
    {name:"silla",img:"https://f.fcdn.app/imgs/6a98bf/www.compramas.com.uy/comauy/2b3e/webp/catalogo/OC-MA_OC-MA-NE_1/1500-1500/silla-de-escritorio-ejecutiva-corporativa-ergonomica-negro.jpg",desc:"SILLA DE ESCRITORIO EJECUTIVA CORPORATIVA ERGONÓMICA",url:"https://www.compramas.com.uy/catalogo/silla-de-escritorio-ejecutiva-corporativa-ergonomica-negro_OC-MA_OC-MA-NE",ambiente:["Oficina"],presupuesto:["Económico","Intermedio"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Adulto","Joven"]},

    {name:"biblioteca",img:"https://f.fcdn.app/imgs/c7a961/www.compramas.com.uy/comauy/06f4/webp/catalogo/MY-905_MY-905_1/1500-1500/biblioteca-estanteria-multiuso-madera-maciza-linea-rustica-biblioteca-estanteria-multiuso-madera-maciza-linea-rustica.jpg",desc:"BIBLIOTECA ESTANTERÍA MULTIUSO MADERA MACIZA",url:"https://www.compramas.com.uy/catalogo/biblioteca-estanteria-multiuso-madera-maciza-linea-rustica_MY-905_MY-905",ambiente:["Oficina","Living"],presupuesto:["Premium"],estilo:["Clásico","Rústico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Adulto"]},

    {name:"Escritorio 1",img:"https://f.fcdn.app/imgs/a3f34e/www.compramas.com.uy/comauy/4ac6/webp/catalogo/NT2060_NT2060-NO_1/1000x1000/escritorio-2-cajones-mesa-para-pc-laptop-computadora-doble-montaje-color-madera.jpg",desc:"ESCRITORIO 2 CAJONES MESA PARA PC LAPTOP COMPUTADORA DOBLE MONTAJE",url:"https://www.compramas.com.uy/catalogo/escritorio-2-cajones-mesa-para-pc-laptop-computadora-doble-montaje-color-madera_NT2060_NT2060-NO",ambiente:["Oficina"],presupuesto:["Económico","Intermedio"],estilo:["Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Adulto"]},
    {name:"Escritorio 2",img:"https://f.fcdn.app/imgs/d91c36/www.compramas.com.uy/comauy/7c19/webp/catalogo/ATC1570_ATC1570_1/1500-1500/escritorio-corporativo-1-cajon-mesa-para-pc-laptop-computadora-escritorio-corporativo-1-cajon-mesa-para-pc-laptop-computadora.jpg",desc:"ESCRITORIO CORPORATIVO 1 CAJÓN MESA PARA PC LAPTOP COMPUTADORA",url:"https://www.compramas.com.uy/catalogo/escritorio-corporativo-1-cajon-mesa-para-pc-laptop-computadora_ATC1570_ATC1570",ambiente:["Oficina"],presupuesto:["Intermedio"],estilo:["Clásico","Moderno"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Adulto"]},

    {name:"biblioteca 1",img:"https://f.fcdn.app/imgs/31c5d1/www.compramas.com.uy/comauy/3560/webp/catalogo/ES-003_ES-003CAN_1/1500-1500/biblioteca-2-puertas-estanteria-organizador-con-llaves-color-madera.jpg",desc:"BIBLIOTECA 2 PUERTAS ESTANTERÍA ORGANIZADOR CON LLAVES",url:"https://www.compramas.com.uy/catalogo/biblioteca-2-puertas-estanteria-organizador-con-llaves-color-madera_ES-003_ES-003CAN",ambiente:["Oficina"],presupuesto:["Económico"],estilo:["Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Adulto","Joven"]},
    {name:"biblioteca 2",img:"https://f.fcdn.app/imgs/b79832/www.compramas.com.uy/comauy/8b8e/webp/catalogo/P1101_P1101-CR_1/1000x1000/biblioteca-estanteria-organizador-2-puertas-en-madera-maciza-en-linea-mexicana-color-madera.jpg",desc:"BIBLIOTECA ESTANTERÍA ORGANIZADOR 2 PUERTAS EN MADERA MACIZA EN LÌNEA MEXICANA",url:"https://www.compramas.com.uy/catalogo/biblioteca-estanteria-organizador-2-puertas-en-madera-maciza-en-linea-mexicana-color-madera_P1101_P1101-CR",ambiente:["Oficina"],presupuesto:["Económico","Intermedio"],estilo:["Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Joven","Adulto"]},

    {name:"rack gamer",img:"https://f.fcdn.app/imgs/920c30/www.compramas.com.uy/comauy/5a84/webp/catalogo/R-220428-N_R-220428-N_1/1500-1500/rack-gamer-aparador-para-tv-50-o-audio-rack-gamer-aparador-para-tv-50-o-audio.jpg",desc:"RACK GAMER APARADOR PARA TV 50¨ O AUDIO",url:"https://www.compramas.com.uy/catalogo/rack-gamer-aparador-para-tv-50-o-audio_R-220428-N_R-220428-N",ambiente:["Oficina","Dormitorio"],presupuesto:["Económico"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona","Para 2 personas","Para 3 o más personas"],edad_persona:["Joven","Niño"]}
    {name:"escritorio gamer",img:"https://f.fcdn.app/imgs/63d5ee/www.compramas.com.uy/comauy/fc80/webp/catalogo/NT2020_NT2020-R_1/1500-1500/escritorio-gamer-para-pc-laptop-computadora-tapa-25-mm-rojo.jpg",desc:"ESCRITORIO GAMER PARA PC LAPTOP COMPUTADORA TAPA 25 MM",url:"https://www.compramas.com.uy/catalogo/escritorio-gamer-para-pc-laptop-computadora-tapa-25-mm-rojo_NT2020_NT2020-R",ambiente:["Oficina","Dormitorio"],presupuesto:["Económico"],estilo:["Moderno","Clásico"],uso_persona:["Para 1 persona"],edad_persona:["Niño","Joven"]},
  ]

  let i=0,a={}
  const root=document.getElementById("cmq-root")
  const body=root.querySelector(".cmq-body")
  const bar=root.querySelector(".cmq-bar-fill")
  const stepText=root.querySelector(".cmq-step-text")
  const back=root.querySelector(".cmq-back")
  const next=root.querySelector(".cmq-next")

  function render(){
    const s=steps[i]
    bar.style.width=((i+1)/steps.length*100)+"%"
    stepText.textContent="Pregunta "+(i+1)+" de "+steps.length
    back.style.visibility=i===0?"hidden":"visible"
    next.textContent=i===steps.length-1?"Ver resultados":"Siguiente"
    next.disabled=!a[s.k]

    body.innerHTML='<div class="cmq-question">'+s.q+'</div>'+
      s.o.map(v=>'<div class="cmq-option'+(a[s.k]===v?' active':'')+'" data-v="'+v+'">'+v+'</div>').join("")

    body.querySelectorAll(".cmq-option").forEach(el=>{
      el.onclick=()=>{a[s.k]=el.dataset.v;render()}
    })
  }
  // Función para calcular score de coincidencia de producto con respuestas
  function calculateScore(product, answers) {
    let score = 0

    // Ambiente (peso: 3 - fundamental)
    if (product.ambiente.includes(answers.ambiente)) score += 3

    // Presupuesto (peso: 2 - importante)
    if (product.presupuesto.includes(answers.presupuesto)) score += 2

    // Estilo (peso: 2 - importante para estética)
    if (product.estilo.includes(answers.estilo)) score += 2

    // Uso persona (peso: 2 - importante para funcionalidad)
    if (product.uso_persona.includes(answers.uso_persona)) score += 2

    // Edad persona (peso: 1 - relevante pero menor)
    if (product.edad_persona.includes(answers.edad_persona)) score += 1

    return score
  }

  function showResults(){
    // Calcular score para todos los productos
    const scoredProducts = allProducts.map(product => ({
      ...product,
      score: calculateScore(product, a)
    }))

    // Ordenar por score descendente y tomar los mejores 4
    const recommendedProducts = scoredProducts
      .sort((a, b) => b.score - a.score)
      .slice(0, 4)

    // Generar mensaje personalizado basado en respuestas
    const ambiente = a.ambiente || "tu espacio"
    const estilo = a.estilo || "tu estilo preferido"
    const presupuesto = a.presupuesto || "tu presupuesto"

    root.querySelector(".cmq-header h2").textContent="¡Estos productos son perfectos para vos!"
    root.querySelector(".cmq-header p").textContent=`Basado en tus respuestas (${ambiente}, ${estilo}, ${presupuesto}), seleccionamos estos productos ideales`
    root.querySelector(".cmq-progress").style.display="none"
    root.querySelector(".cmq-footer").innerHTML='<button class="cmq-back-to-quiz">Hacer el quiz de nuevo</button>'

    body.innerHTML='<div class="cmq-results"><div class="cmq-products">'+
      recommendedProducts.map(p=>
        '<a href="'+p.url+'" target="_blank" rel="noopener noreferrer" class="cmq-product">'+
          '<img src="'+p.img+'" alt="'+p.name+'" class="cmq-product-img">'+
          '<div class="cmq-product-name">'+p.name+'</div>'+
          '<div class="cmq-product-desc">'+p.desc+'</div>'+
          '<div class="cmq-product-cta">Ver producto</div>'+
        '</a>'
      ).join("")+
    '</div></div>'

    root.querySelector(".cmq-back-to-quiz").onclick=()=>{
      i=0;a={}
      root.querySelector(".cmq-header h2").textContent="¿No sabés qué comprar?"
      root.querySelector(".cmq-header p").textContent="Respondé estas preguntas y te guiamos"
      root.querySelector(".cmq-progress").style.display="block"
      root.querySelector(".cmq-footer").innerHTML='<button class="cmq-back">Volver</button><button class="cmq-next">Siguiente</button>'
      bindEvents()
      render()
    }
  }

  function bindEvents(){
    const backBtn=root.querySelector(".cmq-back")
    const nextBtn=root.querySelector(".cmq-next")
    backBtn.onclick=()=>{if(i>0){i--;render()}}
    nextBtn.onclick=()=>{if(i<steps.length-1){i++;render()}else showResults()}
  }
  bindEvents()
  render()
})()
</script>
